<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>Linux服务器微信机器人 | Hustler&#39;s Blog</title>
  <meta name="author" content="Hustler">
  
  <meta name="description" content="Everybody needs love,but hacker dont">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Linux服务器微信机器人"/>
  <meta property="og:site_name" content="Hustler&#39;s Blog"/>

  
    <meta property="og:image" content=""/>
  

  
    <link rel="alternative" href="/atom.xml" title="Hustler&#39;s Blog" type="application/atom+xml">
  
  
    <link href="/favicon.png" rel="icon">
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  
  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-70812759-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-70812759-1');
</script>


<meta name="generator" content="Hexo 7.1.1"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">Hustler&#39;s Blog</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/categories" title="All the categories.">
			  <i class=""></i>Categories
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="All the tags.">
			  <i class=""></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class=""></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/archives" title="Subscribe me.">
			  <i class=""></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> Linux服务器微信机器人</h1>
		</div>
	


<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	
	<!-- content -->
	<div class="mypage">		
	  		

	  <h1 id="鸣谢"><a href="#鸣谢" class="headerlink" title="鸣谢"></a>鸣谢</h1><p>xiaozhao为本项目的测试工作给予了很大帮助，感谢<br>这里是他的博客地址：<a target="_blank" rel="noopener" href="https://aaaaaaamua.github.io/">https://aaaaaaamua.github.io</a></p>
<h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>因为实验室群需要统计最后发言时间，于是写了一个微信机器人，代码和注意事项已经存放在github上，这里仅作个人记录,并备份主程序和部分程序代码<br>项目地址：<a target="_blank" rel="noopener" href="https://github.com/hustler0000/ALinuxSimpleWxbot/">https://github.com/hustler0000/ALinuxSimpleWxbot/</a></p>
<h1 id="帮助-功能文档"><a href="#帮助-功能文档" class="headerlink" title="帮助&#x2F;功能文档"></a>帮助&#x2F;功能文档</h1><p>机器人会默默记下群成员的最后发言时间，@机器人发消息可以触发指令，机器人每天会在群内推送新闻消息，每个小时都会自动微信发送存活信息到我微信</p>
<h2 id="改昵称必看（重要）"><a href="#改昵称必看（重要）" class="headerlink" title="改昵称必看（重要）"></a>改昵称必看（重要）</h2><p>roomname 群昵称 新老群成员可以使用这个修改在数据库里的群昵称，方便机器人称呼和统计最后发言时间，此功能只有在自己修改了群昵称后需要操作一次<br>username 群昵称 此指令可以修改在数据库里的微信昵称，如果机器人没有提示请不要操作<br>以上两条指令，如无必要请不要操作，并且不要同时修改群昵称和微信昵称，不然机器人可能会坏掉</p>
<h2 id="常规指令"><a href="#常规指令" class="headerlink" title="常规指令"></a>常规指令</h2><p>help 显示本帮助文档<br>last 显示本人最后发言时间<br>search 某人 输出某人的最后发言时间<br>all 输出一个文件，里面是所有人的最后发言时间<br>check 检查机器人存活状态<br>feedback 反馈内容 发送反馈</p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><p>当有群成员使用发送反馈时，机器人会向你的主微信账号发送反馈内容，当有新群员加入时，机器人也会提醒你引导成员将自己的群昵称添加进数据库内，当然你也可以手动操作数据库来添加。<br>为了方便地手动操作数据库，还有一个SqliteOperate.py文件，这个python程序提供了简单管理sqlite数据库的条件，运行该程序，并输入相应数据库语句来对你的数据库进行操作。<br>用post请求访问服务器的3001端口下的&#x2F;healthz?token&#x3D;你的token 路径可以检查机器人docker程序是否掉线<br>用get请求访问服务器8080端口下的&#x2F;check 路径可以检查机器人python程序是否掉线</p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>十分简单，因为是二次开发，就是docker收发微信信息，收到的信息通过api转发到python跑的api服务中并且处理</p>
<h1 id="存在问题"><a href="#存在问题" class="headerlink" title="存在问题"></a>存在问题</h1><p>1.程序可能存在sql注入漏洞，可能会导致机器人功能异常<br>2.目前机器人只能部署到一个群内，部署到多个群需要开启多个docker服务和python脚本，十分麻烦且浪费资源<br>3.微信定时两天掉线，详细解决方案以及讨论请查看<a target="_blank" rel="noopener" href="https://github.com/danni-cool/wechatbot-webhook">https://github.com/danni-cool/wechatbot-webhook</a> 内的issue。<br>4.只能用手机先登录机器人的微信账号，然后再扫码登录服务器docker中的微信，而且手机上的机器人微信还不能退出，否则机器人会掉线，即你需要有一台设备一直登录着机器人微信，并且这台设备能随时扫码登录服务器上的微信</p>
<h1 id="源代码"><a href="#源代码" class="headerlink" title="源代码"></a>源代码</h1><h2 id="最初版本的主程序代码"><a href="#最初版本的主程序代码" class="headerlink" title="最初版本的主程序代码"></a>最初版本的主程序代码</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI<span class="token punctuation">,</span> Form
<span class="token keyword">import</span> uvicorn
<span class="token keyword">import</span> json
<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> sqlite3 <span class="token keyword">as</span> sl
<span class="token keyword">import</span> os

flag<span class="token operator">=</span><span class="token number">1</span>
app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/receive_msg"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">print_json</span><span class="token punctuation">(</span>source<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token operator">=</span>Form<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> Form<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> isMentioned<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token operator">=</span>Form<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">&#125;</span>
    source<span class="token operator">=</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>source<span class="token punctuation">)</span>
    s<span class="token operator">=</span>source<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"from"</span><span class="token punctuation">)</span>
    ss<span class="token operator">=</span>s<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"payload"</span><span class="token punctuation">)</span>
    name<span class="token operator">=</span>ss<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
    time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    cont <span class="token operator">=</span> content<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\u2005"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cont<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        con <span class="token operator">=</span> cont<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        concon <span class="token operator">=</span> con<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span>
        con2 <span class="token operator">=</span> concon<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    sql1<span class="token operator">=</span><span class="token string">"select * from POST where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span>
    data<span class="token operator">=</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        flag<span class="token operator">=</span><span class="token number">0</span>
        sql1<span class="token operator">=</span><span class="token string">"replace into POST(username,last_post_time) values('%s','%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql1<span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"我还不认识你，可能因为你是新成员，或者改了微信昵称，不过我已经把你加到我的小本本里了，如果你是新人，请使用：\nroomname 群昵称\n这条指令，在我的小本本上记下你的群昵称，欢迎你！\n\n如果你是修改了微信昵称，请使用：\nusername 你的群昵称\n在我的小本本上记下你的新微信昵称\n请不要同时修改微信昵称和群昵称，不然我真的记不过来呀[流泪]望见谅\n\n@我并输入help指令可以呼出我的帮助菜单哦！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        cmd <span class="token operator">=</span> <span class="token string">'curl --location "http://localhost:3001/webhook/msg" --header "Content-Type: application/json" --data \'&#123;"to": "Doom.","type": "text","content":"有新成员或者有人改了微信昵称，新人或者昵称为'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'，请迅速检查处理!"&#125;\''</span>
        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        flag<span class="token operator">=</span><span class="token number">1</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>isMentioned<span class="token operator">!=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql<span class="token operator">=</span><span class="token string">"update POST set last_post_time='%s' where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span>name<span class="token punctuation">)</span>
        conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>isMentioned<span class="token operator">==</span><span class="token string">"1"</span> <span class="token keyword">and</span> con2<span class="token operator">==</span><span class="token string">"roomname"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql<span class="token operator">=</span><span class="token string">"update POST set roomname='%s' where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>concon<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span>
        conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>isMentioned<span class="token operator">==</span><span class="token string">"1"</span> <span class="token keyword">and</span> con2<span class="token operator">==</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql<span class="token operator">=</span><span class="token string">"update POST set username='%s' where roomname=%'s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>concon<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
        cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        sql <span class="token operator">=</span> <span class="token string">"delete from POST where username='%s' and roomname is null"</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>isMentioned<span class="token operator">==</span><span class="token string">"1"</span> <span class="token keyword">and</span> flag<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"@"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"\u2005真闲！不过如果你真的无聊的话，可以试试sql注入我，帮助主人找漏洞哦！先在此谢过了！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con<span class="token operator">==</span><span class="token string">"help"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"我是Scr1ptKidB0t，我会默默记下大家的最后发言时间\n@我发消息可以触发指令，大家@我的时候要我回复了才能继续@哦：\n\n改昵称必看（重要）：\nroomname 群昵称 新老群成员可以使用这个修改在小本本里的群昵称，方便我称呼和统计最后发言时间，此功能只有在自己修改了群昵称后需要操作一次哦\nusername 群昵称 此指令可以修改在小本本里的微信昵称，如果机器人没有提示请不要操作\n以上两条指令，如无必要请不要操作，并且不要同时修改群昵称和微信昵称，不然机器人可能会坏掉，谢谢\n\nhelp 显示本帮助文档\nlast 显示本人最后发言时间\nsearch 某人 输出某人的最后发言时间\nall 输出一个文件，里面是所有人的最后发言时间\nfeedback 反馈内容 发送反馈\n\n项目地址：https://github.com/danni-cool/wechatbot-webhook\n使用指南：https://www.bilibili.com/read/cv28706223/\n\n希望大家珍惜我，不要@我刷屏，不要连续@我，玩坏了掉线了及时告知我的主人，希望能和大家一起进步呀"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con<span class="token operator">==</span><span class="token string">"last"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sql<span class="token operator">=</span><span class="token string">"select roomname,last_post_time from POST where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
            conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
            cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            d<span class="token operator">=</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            d0<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            d00<span class="token operator">=</span>d0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            d1<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            d11<span class="token operator">=</span>d1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"你好"</span><span class="token operator">+</span>d00<span class="token operator">+</span><span class="token string">"\n你最后的发言时间是："</span><span class="token operator">+</span>d11<span class="token operator">+</span><span class="token string">"\n记得要多发言，营造活跃的群内气氛哦！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con2<span class="token operator">==</span><span class="token string">"search"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            menb<span class="token operator">=</span>concon<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            sql<span class="token operator">=</span><span class="token string">"select roomname,last_post_time from POST where username='%s' or roomname='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>menb<span class="token punctuation">,</span>menb<span class="token punctuation">)</span>
            conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
            cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            d<span class="token operator">=</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            d0<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            d00<span class="token operator">=</span>d0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            d1<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            d11<span class="token operator">=</span>d1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"你好"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"\n"</span><span class="token operator">+</span>d00<span class="token operator">+</span><span class="token string">"最后的发言时间是："</span><span class="token operator">+</span>d11<span class="token operator">+</span><span class="token string">"\n记得要多发言，营造活跃的群内气氛哦！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con<span class="token operator">==</span><span class="token string">"all"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sql<span class="token operator">=</span><span class="token string">"select id,roomname,last_post_time from POST"</span>
            conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
            cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                item<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
                ii<span class="token operator">=</span>item<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
                <span class="token builtin">id</span><span class="token operator">=</span>ii<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
                rn<span class="token operator">=</span>ii<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
                roomname<span class="token operator">=</span>rn<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                t<span class="token operator">=</span>ii<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
                time<span class="token operator">=</span>t<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">id</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"all_menbers.txt"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>roomname<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>time<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
                        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"all_menbers.txt"</span><span class="token punctuation">,</span><span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>roomname<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>time<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
                        f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"curl --location --request POST 'http://localhost:3001/webhook/msg' --form 'to=群聊名称' --form content=@'/root/ScriptKidB0T/all_menbers.txt' --form 'isRoom=1'"</span><span class="token punctuation">)</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"以上是大家的发言时间记录，请大家踊跃发言，一起成长呀"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>con2<span class="token operator">==</span><span class="token string">"feedback"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sql<span class="token operator">=</span><span class="token string">"select roomname from POST where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
            conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
            cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
            conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            d<span class="token operator">=</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            d0<span class="token operator">=</span>d<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            d00<span class="token operator">=</span>d0<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"成员"</span><span class="token operator">+</span>d00<span class="token operator">+</span><span class="token string">"，你的反馈我已经告诉主人了，感谢你的支持呀！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
            fb<span class="token operator">=</span>concon<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            cmd<span class="token operator">=</span><span class="token string">'curl --location "http://localhost:3001/webhook/msg" --header "Content-Type: application/json" --data \'&#123;"to": "Doom.","type": "text","content":"群组的'</span><span class="token operator">+</span>d00<span class="token operator">+</span><span class="token string">'发送了反馈，内容为'</span><span class="token operator">+</span>fb<span class="token operator">+</span><span class="token string">'，请迅速处理!"&#125;\''</span>
            os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
    <span class="token keyword">return</span> a

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    uvicorn<span class="token punctuation">.</span>run<span class="token punctuation">(</span>app<span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>最初版本的根本不敢直接放到github上好吗</p>
<h2 id="修改后版本"><a href="#修改后版本" class="headerlink" title="修改后版本"></a>修改后版本</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> apscheduler<span class="token punctuation">.</span>schedulers<span class="token punctuation">.</span>background <span class="token keyword">import</span> BackgroundScheduler
<span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI<span class="token punctuation">,</span> Form
<span class="token keyword">import</span> uvicorn
<span class="token keyword">import</span> json
<span class="token keyword">import</span> datetime
<span class="token keyword">import</span> sqlite3 <span class="token keyword">as</span> sl
<span class="token keyword">import</span> os
<span class="token keyword">import</span> requests
<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup
<span class="token keyword">import</span> feedparser

app <span class="token operator">=</span> FastAPI<span class="token punctuation">(</span><span class="token punctuation">)</span>
scheduler <span class="token operator">=</span> BackgroundScheduler<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">getrss</span><span class="token punctuation">(</span>strings<span class="token punctuation">,</span>url<span class="token punctuation">)</span><span class="token punctuation">:</span>
    d<span class="token operator">=</span>feedparser<span class="token punctuation">.</span>parse<span class="token punctuation">(</span>url<span class="token punctuation">)</span>
    strings<span class="token operator">=</span>strings<span class="token operator">+</span>d<span class="token punctuation">.</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>title<span class="token operator">+</span><span class="token string">"\n"</span>
    strings<span class="token operator">=</span>strings<span class="token operator">+</span><span class="token string">"链接："</span><span class="token operator">+</span>d<span class="token punctuation">.</span>entries<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>link<span class="token operator">+</span><span class="token string">"\n"</span>
    strings <span class="token operator">=</span> strings <span class="token operator">+</span><span class="token string">"来源："</span><span class="token operator">+</span> d<span class="token punctuation">.</span>feed<span class="token punctuation">.</span>title <span class="token operator">+</span> <span class="token string">"\n"</span>
    <span class="token keyword">return</span> strings

<span class="token keyword">def</span> <span class="token function">roomdailynews</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    newurl<span class="token operator">=</span><span class="token string">"https://www.ddosi.org/category/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/"</span>
    header <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
        <span class="token string">'User-Agent'</span><span class="token punctuation">:</span> <span class="token string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36'</span>
    <span class="token punctuation">&#125;</span>
    response <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>newurl<span class="token punctuation">,</span> headers<span class="token operator">=</span>header<span class="token punctuation">)</span>
    response<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> response<span class="token punctuation">.</span>content<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> BeautifulSoup<span class="token punctuation">(</span>response<span class="token punctuation">,</span> <span class="token string">'lxml'</span><span class="token punctuation">)</span>
    response <span class="token operator">=</span> response<span class="token punctuation">.</span>find_all<span class="token punctuation">(</span>attrs<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"class"</span><span class="token punctuation">:</span> <span class="token string">"entry-title"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
    newlink <span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>a<span class="token punctuation">.</span>attrs<span class="token punctuation">[</span><span class="token string">'href'</span><span class="token punctuation">]</span>
    newtitle<span class="token operator">=</span> response<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>text
    todaytime <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S %A'</span><span class="token punctuation">)</span>
    news<span class="token operator">=</span><span class="token string">""</span>
    count<span class="token operator">=</span><span class="token number">1</span>
    rssfile<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"rss.txt"</span><span class="token punctuation">)</span>
    rsslist<span class="token operator">=</span>rssfile<span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> line <span class="token keyword">in</span> rsslist<span class="token punctuation">:</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            news<span class="token operator">=</span>news<span class="token operator">+</span><span class="token string">"早上好！现在是"</span><span class="token operator">+</span>todaytime<span class="token operator">+</span><span class="token string">"\n\n每日快讯:\n"</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">==</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            news<span class="token operator">=</span>news<span class="token operator">+</span><span class="token string">"\n威胁情报：\n"</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">==</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            news<span class="token operator">=</span>news<span class="token operator">+</span><span class="token string">"\n漏洞报告：\n"</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>count<span class="token operator">==</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            news<span class="token operator">=</span>news<span class="token operator">+</span><span class="token string">"\n最新CVE报告：\nhttps://cassandra.cerias.purdue.edu/CVE_changes/today.html\n部分链接需梯子"</span><span class="token operator">+</span><span class="token string">"\n\n安全文章：\n"</span><span class="token operator">+</span>newtitle<span class="token operator">+</span><span class="token string">"\n"</span><span class="token operator">+</span>newlink<span class="token operator">+</span><span class="token string">"\n来源：https://www.ddosi.org/category/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/\n"</span>
        news<span class="token operator">=</span>getrss<span class="token punctuation">(</span>news<span class="token punctuation">,</span>line<span class="token punctuation">)</span>
        count<span class="token operator">=</span>count<span class="token operator">+</span><span class="token number">1</span>
    news<span class="token operator">=</span>news<span class="token operator">+</span><span class="token string">"以上就是今早的新内容，一起来学习呀！"</span>
    url1 <span class="token operator">=</span> <span class="token string">'http://127.0.0.1:3001/webhook/msg'</span>
    headers1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"content-type"</span><span class="token punctuation">:</span><span class="token string">"application/json"</span><span class="token punctuation">&#125;</span>
    payload1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"to"</span><span class="token punctuation">:</span><span class="token string">"群聊名称"</span><span class="token punctuation">,</span><span class="token string">"isRoom"</span><span class="token punctuation">:</span> <span class="token boolean">True</span> <span class="token punctuation">,</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span>news<span class="token punctuation">&#125;</span>
    requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url1<span class="token punctuation">,</span>json<span class="token operator">=</span>payload1<span class="token punctuation">,</span>headers<span class="token operator">=</span>headers1<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">wxautocheck</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    reply <span class="token operator">=</span> <span class="token string">'curl --location "http://localhost:3001/webhook/msg" --header "Content-Type: application/json" --data \'&#123;"to": "Doom.","type": "text","content":"I am still alive!"&#125;\''</span>
    os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>reply<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>on_event</span><span class="token punctuation">(</span><span class="token string">"startup"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">app_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    scheduler<span class="token punctuation">.</span>add_job<span class="token punctuation">(</span>roomdailynews<span class="token punctuation">,</span> <span class="token string">'interval'</span><span class="token punctuation">,</span> days<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    scheduler<span class="token punctuation">.</span>add_job<span class="token punctuation">(</span>wxautocheck<span class="token punctuation">,</span> <span class="token string">'interval'</span><span class="token punctuation">,</span> hours<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    scheduler<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>get</span><span class="token punctuation">(</span><span class="token string">"/check"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token operator">=</span><span class="token string">"success!"</span>
    <span class="token keyword">return</span> a

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/receive_msg"</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token keyword">def</span> <span class="token function">print_json</span><span class="token punctuation">(</span>source<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token operator">=</span>Form<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> <span class="token builtin">str</span> <span class="token operator">=</span> Form<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> isMentioned<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token operator">=</span>Form<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">&#125;</span>
    source<span class="token operator">=</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>source<span class="token punctuation">)</span>
    source<span class="token operator">=</span>source<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"from"</span><span class="token punctuation">)</span>
    source<span class="token operator">=</span>source<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"payload"</span><span class="token punctuation">)</span>
    name<span class="token operator">=</span>source<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>
    time<span class="token operator">=</span>datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d %H:%M:%S'</span><span class="token punctuation">)</span>
    args <span class="token operator">=</span> content<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\u2005"</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token operator">></span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        args <span class="token operator">=</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
        args <span class="token operator">=</span> args<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">,</span>maxsplit<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
    sql<span class="token operator">=</span><span class="token string">"select * from POST where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
    conn <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    data<span class="token operator">=</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>data<span class="token operator">==</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql<span class="token operator">=</span><span class="token string">"replace into POST(username,last_post_time) values('%s','%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span> time<span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
        a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"我还不认识你，可能因为你是新成员，或者改了微信昵称，不过我已经把你加到我的小本本里了，如果你是新人，请使用：\nroomname 群昵称\n这条指令，在我的小本本上记下你的群昵称，欢迎你加入大家庭！\n\n如果你是修改了微信昵称，请使用：\nusername 你的群昵称\n在我的小本本上记下你的新微信昵称\n请不要同时修改微信昵称和群昵称，不然我真的记不过来呀[流泪]望见谅\n\n@我并输入help可以呼出我的帮助菜单哦！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        cmd <span class="token operator">=</span> <span class="token string">'curl --location "http://localhost:3001/webhook/msg" --header "Content-Type: application/json" --data \'&#123;"to": "Doom.","type": "text","content":"有新成员或者有人改了微信昵称，新人或者昵称为'</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">'，请迅速检查处理!"&#125;\''</span>
        os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
    <span class="token keyword">elif</span><span class="token punctuation">(</span>isMentioned<span class="token operator">!=</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        sql<span class="token operator">=</span><span class="token string">"update POST set last_post_time='%s' where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>time<span class="token punctuation">,</span>name<span class="token punctuation">)</span>
        cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"@"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"\u2005真闲！不过如果你真的无聊的话，可以试试sql注入我，帮助主人找漏洞哦！先在此谢过了！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"roomname"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sql<span class="token operator">=</span><span class="token string">"update POST set roomname='%s' where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>name<span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            sql<span class="token operator">=</span><span class="token string">"select roomname from POST where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            data <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            dname <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            dname <span class="token operator">=</span> dname<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"成功修改小本本上的群昵称为"</span><span class="token operator">+</span>dname<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"username"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sql<span class="token operator">=</span><span class="token string">"update POST set username='%s' where roomname='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">,</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            sql <span class="token operator">=</span> <span class="token string">"delete from POST where username='%s' and roomname is null"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            sql<span class="token operator">=</span><span class="token string">"select username from POST where roomname='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            data <span class="token operator">=</span> data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            dname <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            dname <span class="token operator">=</span> dname<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"成功修改小本本上的微信名称为"</span> <span class="token operator">+</span> dname<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"check"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            a <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span> <span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span> <span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"I am still alive!"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"help"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"我是Scr1ptKidB0t，我会默默记下大家的最后发言时间\n@我发消息可以触发指令，大家@我的时候要我回复了才能继续@哦：\n\n改昵称必看（重要）：\nroomname 群昵称 新老群成员可以使用这个修改在小本本里的群昵称，方便我称呼和统计最后发言时间，此功能只有在自己修改了群昵称后需要操作一次哦\nusername 群昵称 此指令可以修改在小本本里的微信昵称，如果机器人没有提示请不要操作\n以上两条指令，如无必要请不要操作，并且不要同时修改群昵称和微信昵称，不然机器人可能会坏掉，谢谢\n\nhelp 显示本帮助文档\nlast 显示本人最后发言时间\nsearch 某人 输出某人的最后发言时间\nall 输出一个文件，里面是所有人的最后发言时间\ncheck 检查机器人存活状态\nfeedback 反馈内容 发送反馈\n\n项目地址：https://github.com/hustler0000/SimpleWxbot\n\n希望大家珍惜我，不要@我刷屏，不要连续@我，玩坏了掉线了及时告知我的主人，希望能和大家一起进步呀"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"last"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sql<span class="token operator">=</span><span class="token string">"select roomname,last_post_time from POST where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            data<span class="token operator">=</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            dname<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            dname<span class="token operator">=</span>dname<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            dtime<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            dtime<span class="token operator">=</span>dtime<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"你好"</span><span class="token operator">+</span>dname<span class="token operator">+</span><span class="token string">"\n你最后的发言时间是："</span><span class="token operator">+</span>dtime<span class="token operator">+</span><span class="token string">"\n记得要多发言，营造活跃的群内气氛哦！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"search"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            menb<span class="token operator">=</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            sql<span class="token operator">=</span><span class="token string">"select roomname,last_post_time from POST where username='%s' or roomname='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>menb<span class="token punctuation">,</span>menb<span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            data<span class="token operator">=</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            dname<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            dname<span class="token operator">=</span>dname<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            dtime<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            dtime<span class="token operator">=</span>dtime<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">]</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span> <span class="token string">"你好"</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">"\n"</span><span class="token operator">+</span>dname<span class="token operator">+</span><span class="token string">"最后的发言时间是："</span><span class="token operator">+</span>dtime<span class="token operator">+</span><span class="token string">"\n记得要多发言，营造活跃的群内气氛哦！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"all"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"rm -rf all_menbers.txt"</span><span class="token punctuation">)</span>
            sql<span class="token operator">=</span><span class="token string">"select id,roomname,last_post_time from POST"</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"all_menbers.txt"</span><span class="token punctuation">,</span> <span class="token string">"a"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
                <span class="token keyword">for</span> item <span class="token keyword">in</span> data<span class="token punctuation">:</span>
                    item<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
                    item<span class="token operator">=</span>item<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
                    roomname<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
                    roomname<span class="token operator">=</span>roomname<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
                    time<span class="token operator">=</span>item<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
                    time<span class="token operator">=</span>time<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span>
                    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>roomname<span class="token operator">+</span><span class="token string">" "</span><span class="token operator">+</span>time<span class="token operator">+</span><span class="token string">"\n"</span><span class="token punctuation">)</span>
                f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
            os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"curl --location --request POST 'http://localhost:3001/webhook/msg' --form 'to=群聊名称' --form content=@'/root/ScriptKidB0T/all_menbers.txt' --form 'isRoom=1'"</span><span class="token punctuation">)</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"以上是大家的发言时间记录，请大家踊跃发言，一起成长呀"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">"feedback"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            sql<span class="token operator">=</span><span class="token string">"select roomname from POST where username='%s'"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>name<span class="token punctuation">)</span>
            cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
            data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
            data<span class="token operator">=</span><span class="token builtin">str</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
            data<span class="token operator">=</span>data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span>
            dname<span class="token operator">=</span>data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            dname<span class="token operator">=</span>dname<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
            a<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"success"</span><span class="token punctuation">:</span> <span class="token boolean">True</span><span class="token punctuation">,</span><span class="token string">"data"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"type"</span><span class="token punctuation">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span><span class="token string">"content"</span><span class="token punctuation">:</span><span class="token string">"成员"</span><span class="token operator">+</span>dname<span class="token operator">+</span><span class="token string">"，你的反馈我已经告诉主人了，感谢你的支持呀！"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
            fb<span class="token operator">=</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
            cmd<span class="token operator">=</span><span class="token string">'curl --location "http://localhost:3001/webhook/msg" --header "Content-Type: application/json" --data \'&#123;"to": "Doom.","type": "text","content":"群组的'</span><span class="token operator">+</span>dname<span class="token operator">+</span><span class="token string">'发送了反馈，内容为'</span><span class="token operator">+</span>fb<span class="token operator">+</span><span class="token string">'，请迅速处理!"&#125;\''</span>
            os<span class="token punctuation">.</span>system<span class="token punctuation">(</span>cmd<span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> a

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    uvicorn<span class="token punctuation">.</span>run<span class="token punctuation">(</span>app<span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">"0.0.0.0"</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8080</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>github版本</p>
<h2 id="sqlite3数据库操作程序"><a href="#sqlite3数据库操作程序" class="headerlink" title="sqlite3数据库操作程序"></a>sqlite3数据库操作程序</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sqlite3 <span class="token keyword">as</span> sl

<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sql <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">">>>"</span><span class="token punctuation">)</span>
    con <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> con<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    data <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    con<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    con<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="创建初始数据库程序"><a href="#创建初始数据库程序" class="headerlink" title="创建初始数据库程序"></a>创建初始数据库程序</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pywinauto<span class="token punctuation">.</span>application <span class="token keyword">import</span> Application
<span class="token keyword">import</span> pywinauto
<span class="token keyword">import</span> time
<span class="token keyword">import</span> psutil
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> sqlite3 <span class="token keyword">as</span> sl
<span class="token keyword">import</span> csv


<span class="token keyword">def</span> <span class="token function">get_wechat_pid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    pids <span class="token operator">=</span> psutil<span class="token punctuation">.</span>pids<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> pid <span class="token keyword">in</span> pids<span class="token punctuation">:</span>
        p <span class="token operator">=</span> psutil<span class="token punctuation">.</span>Process<span class="token punctuation">(</span>pid<span class="token punctuation">)</span>
        <span class="token keyword">if</span> p<span class="token punctuation">.</span>name<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string">'WeChat.exe'</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> pid
    <span class="token keyword">return</span> <span class="token boolean">None</span>


<span class="token keyword">def</span> <span class="token function">get_name_list</span><span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>>> WeChat.exe pid: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>pid<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>>> 请打开【微信=>目标群聊=>聊天成员=>查看更多】，尤其是【查看更多】，否则查找不全！'</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\r(&#123;:2d&#125; 秒)'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token number">20</span> <span class="token operator">-</span> i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
        time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    app <span class="token operator">=</span> Application<span class="token punctuation">(</span>backend<span class="token operator">=</span><span class="token string">'uia'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span>process<span class="token operator">=</span>pid<span class="token punctuation">)</span>
    win_main_Dialog <span class="token operator">=</span> app<span class="token punctuation">.</span>window<span class="token punctuation">(</span>class_name<span class="token operator">=</span><span class="token string">'WeChatMainWndForPC'</span><span class="token punctuation">)</span>
    chat_list <span class="token operator">=</span> win_main_Dialog<span class="token punctuation">.</span>child_window<span class="token punctuation">(</span>control_type<span class="token operator">=</span><span class="token string">'List'</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">'聊天成员'</span><span class="token punctuation">)</span>
    name_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    all_members <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> chat_list<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        p <span class="token operator">=</span> i<span class="token punctuation">.</span>descendants<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> p <span class="token keyword">and</span> <span class="token builtin">len</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">5</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> p<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">and</span> p<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">''</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'添加'</span> <span class="token keyword">and</span> p<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">'移出'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                name_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>p<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                all_members<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>p<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>texts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>all_members<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>to_csv<span class="token punctuation">(</span><span class="token string">'all_members.csv'</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'群昵称'</span><span class="token punctuation">,</span> <span class="token string">'微信昵称'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\r>>> 群成员共 &#123;&#125; 人，结果已保存至all_members.csv'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>name_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> name_list


<span class="token keyword">def</span> <span class="token function">match</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    pid <span class="token operator">=</span> get_wechat_pid<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> pid <span class="token operator">==</span> <span class="token boolean">None</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>>> 找不到WeChat.exe，请先打开WeChat.exe再运行此脚本！'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        member_list <span class="token operator">=</span> get_name_list<span class="token punctuation">(</span>pid<span class="token punctuation">)</span>
    <span class="token keyword">except</span> pywinauto<span class="token punctuation">.</span>findwindows<span class="token punctuation">.</span>ElementNotFoundError <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\r>>> 未找到【聊天成员】窗口，程序终止！'</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'>>> 若已开启【聊天成员】窗口但仍报错，请重启微信（原因：可能存在多个WeChat进程）'</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    <span class="token keyword">match</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    sql <span class="token operator">=</span> <span class="token string">'create table if not exists POST(id integer primary key autoincrement,username text,roomname text ,last_post_time text)'</span>
    con <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
    cursor <span class="token operator">=</span> con<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
    con<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
    con<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"init ok"</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"all_members.csv"</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8-sig"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> mb<span class="token punctuation">:</span>
        reader <span class="token operator">=</span> csv<span class="token punctuation">.</span>reader<span class="token punctuation">(</span>mb<span class="token punctuation">)</span>
        <span class="token keyword">for</span> row <span class="token keyword">in</span> reader<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">"群昵称"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                sql <span class="token operator">=</span> <span class="token string">"replace into POST(username,roomname) values('%s','%s')"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                con <span class="token operator">=</span> sl<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token string">'menbers.db'</span><span class="token punctuation">)</span>
                cursor <span class="token operator">=</span> con<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>
                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>
                con<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>
                con<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">"ok"</span><span class="token punctuation">)</span>
        mb<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSS链接"><a href="#RSS链接" class="headerlink" title="RSS链接"></a>RSS链接</h2><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/feed">https://www.freebuf.com/feed</a><br><a target="_blank" rel="noopener" href="https://www.sec-wiki.com/news/rss">https://www.sec-wiki.com/news/rss</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/de09ec267e5c4545e0a759cc62c3da7866ea49e0.xml">https://wechat2rss.xlab.app/feed/de09ec267e5c4545e0a759cc62c3da7866ea49e0.xml</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/b93962f981247c0091dad08df5b7a6864ab888e9.xml">https://wechat2rss.xlab.app/feed/b93962f981247c0091dad08df5b7a6864ab888e9.xml</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/7874947663d806190d77bdca6f8f6855f65a1b20.xml">https://wechat2rss.xlab.app/feed/7874947663d806190d77bdca6f8f6855f65a1b20.xml</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/034265b14906a59ef7cf1fcbd56699b54a696094.xml">https://wechat2rss.xlab.app/feed/034265b14906a59ef7cf1fcbd56699b54a696094.xml</a><br><a target="_blank" rel="noopener" href="https://www.seebug.org/rss/new/">https://www.seebug.org/rss/new/</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/981c000a01bbdc1f128d260cc91c15d3a6afb530.xml">https://wechat2rss.xlab.app/feed/981c000a01bbdc1f128d260cc91c15d3a6afb530.xml</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/90c827b8290310a96ef80a13df9dbcc06ab69892.xml">https://wechat2rss.xlab.app/feed/90c827b8290310a96ef80a13df9dbcc06ab69892.xml</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/6ce082e908ac0894ff00b2d9d8e186181cd810bd.xml">https://wechat2rss.xlab.app/feed/6ce082e908ac0894ff00b2d9d8e186181cd810bd.xml</a><br><a target="_blank" rel="noopener" href="https://paper.seebug.org/rss">https://paper.seebug.org/rss</a><br><a target="_blank" rel="noopener" href="https://xz.aliyun.com/feed">https://xz.aliyun.com/feed</a><br><a target="_blank" rel="noopener" href="https://wechat2rss.xlab.app/feed/837190f74457627e0a5567700c573fe8afd7d3fe.xml">https://wechat2rss.xlab.app/feed/837190f74457627e0a5567700c573fe8afd7d3fe.xml</a><br><a target="_blank" rel="noopener" href="https://www.secpulse.com/feed">https://www.secpulse.com/feed</a></p>
<h1 id="未来走向"><a href="#未来走向" class="headerlink" title="未来走向"></a>未来走向</h1><p>1.考虑多群部署，添加私聊检测机器人是否活着的功能<br>2.考虑添加GPT或者谷歌AI，制作一个AI助理</p>

	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>

</div>


	</div>

	
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/2024/02/04/winwxbot/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/2024/01/24/hexoblog/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>


    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>
-->
	
	
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2024-02-04 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/个人项目/">个人项目<span>3</span></a></li>

<div class="widget tag">
  <h3 class="title">All Categories</h3>
     <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/SRC%E6%8C%96%E6%8E%98/">SRC挖掘</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E9%A1%B9%E7%9B%AE/">个人项目</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/">渗透测试</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/">竞赛</a><span class="category-list-count">22</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/AWD/">AWD</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/CTF/">CTF</a><span class="category-list-count">21</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/CTF/Crypto/">Crypto</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/CTF/Misc/">Misc</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/CTF/PWN/">PWN</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/CTF/Reverse/">Reverse</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%AB%9E%E8%B5%9B/CTF/Web/">Web</a><span class="category-list-count">9</span></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%80%9F%E6%9F%A5/">速查</a><span class="category-list-count">4</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%80%9F%E6%9F%A5/CTF/">CTF</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%80%9F%E6%9F%A5/%E5%8D%9A%E5%AE%A2/">博客</a><span class="category-list-count">2</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/">靶场练习</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/OSCP/">OSCP</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/OSCP/Vulnhub/">Vulnhub</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/OSCP/Vulnhub/Easy/">Easy</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E9%9D%B6%E5%9C%BA%E7%BB%83%E4%B9%A0/OSCP/Vulnhub/Intermediate/">Intermediate</a><span class="category-list-count">3</span></li></ul></li></ul></li></ul></li></ul> 
</div>
 
  </li>
    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/项目/">项目<span>3</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->
		

	</div>
	
		

</div><!-- row -->

<!-- -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2025 Hustler's Blog
  
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>.Theme <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank">freemind.bithack</a>  
</p>
<br>
<p>
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
            <span id="busuanzi_container_site_uv" style="display: inline;">本站总访问量<span id="busuanzi_value_site_uv"></span>次</span>
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
